(function(s,u){typeof exports=="object"&&typeof module!="undefined"?u():typeof define=="function"&&define.amd?define(u):u()})(0,function(){"use strict";function s(t){var n=this.constructor;return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){return n.reject(e)})})}function u(){}function r(t){if(!(this instanceof r))throw new TypeError("Promises must be constructed via new");if(typeof t!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],_(t,this)}function v(t,n){for(;t._state===3;)t=t._value;t._state!==0?(t._handled=!0,r._immediateFn(function(){var e=t._state===1?n.onFulfilled:n.onRejected;if(e!==null){var o;try{o=e(t._value)}catch(i){return void c(n.promise,i)}d(n.promise,o)}else(t._state===1?d:c)(n.promise,t._value)})):t._deferreds.push(n)}function d(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&(typeof n=="object"||typeof n=="function")){var e=n.then;if(n instanceof r)return t._state=3,t._value=n,void h(t);if(typeof e=="function")return void _(function(o,i){return function(){o.apply(i,arguments)}}(e,n),t)}t._state=1,t._value=n,h(t)}catch(o){c(t,o)}}function c(t,n){t._state=2,t._value=n,h(t)}function h(t){t._state===2&&t._deferreds.length===0&&r._immediateFn(function(){t._handled||r._unhandledRejectionFn(t._value)});for(var n=0,e=t._deferreds.length;e>n;n++)v(t,t._deferreds[n]);t._deferreds=null}function _(t,n){var e=!1;try{t(function(o){e||(e=!0,d(n,o))},function(o){e||(e=!0,c(n,o))})}catch(o){if(e)return;e=!0,c(n,o)}}var b=setTimeout;r.prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(t,n){var e=new this.constructor(u);return v(this,new function(o,i,p){this.onFulfilled=typeof o=="function"?o:null,this.onRejected=typeof i=="function"?i:null,this.promise=p}(t,n,e)),e},r.prototype.finally=s,r.all=function(t){return new r(function(n,e){function o(m,f){try{if(f&&(typeof f=="object"||typeof f=="function")){var w=f.then;if(typeof w=="function")return void w.call(f,function(y){o(m,y)},e)}i[m]=f,--p==0&&n(i)}catch(y){e(y)}}if(!t||typeof t.length=="undefined")throw new TypeError("Promise.all accepts an array");var i=Array.prototype.slice.call(t);if(i.length===0)return n([]);for(var p=i.length,a=0;i.length>a;a++)o(a,i[a])})},r.resolve=function(t){return t&&typeof t=="object"&&t.constructor===r?t:new r(function(n){n(t)})},r.reject=function(t){return new r(function(n,e){e(t)})},r.race=function(t){return new r(function(n,e){for(var o=0,i=t.length;i>o;o++)t[o].then(n,e)})},r._immediateFn=typeof setImmediate=="function"&&function(t){setImmediate(t)}||function(t){b(t,0)},r._unhandledRejectionFn=function(t){console!==void 0&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var l=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw Error("unable to locate global object")}();"Promise"in l?l.Promise.prototype.finally||(l.Promise.prototype.finally=s):l.Promise=r});
