MathJax.Hub.Register.StartupHook("Sre Ready",function(){var d,u,s=MathJax.Hub.config.menuSettings,g={};MathJax.Hub.Register.StartupHook("MathEvents Ready",function(){d=MathJax.Extension.MathEvents.Event.False,u=MathJax.Extension.MathEvents.Event.KEY});var o=MathJax.Extension.explorer={version:"1.6.0",dependents:[],defaults:{walker:"table",highlight:"none",background:"blue",foreground:"black",speech:!0,generation:"lazy",subtitle:!1,ruleset:"mathspeak-default"},eagerComplexity:80,prefix:"Assistive-",hook:null,locHook:null,oldrules:null,addMenuOption:function(t,e){s[o.prefix+t]=e},addDefaults:function(){for(var t,e=MathJax.Hub.CombineConfig("explorer",o.defaults),n=Object.keys(e),i=0;t=n[i];i++)s[o.prefix+t]===void 0&&o.addMenuOption(t,e[t]);o.setSpeechOption(),a.Reset()},setOption:function(t,e){s[o.prefix+t]!==e&&(o.addMenuOption(t,e),a.Reset())},getOption:function(t){return s[o.prefix+t]},speechOption:function(t){o.oldrules!==t.value&&(o.setSpeechOption(),a.Regenerate())},setSpeechOption:function(){var t=s[o.prefix+"ruleset"],e=t.split("-");sre.System.getInstance().setupEngine({locale:MathJax.Localization.locale,domain:o.Domain(e[0]),style:e[1]}),o.oldrules=t},Domain:function(t){switch(t){case"chromevox":return"default";case"clearspeak":return"clearspeak";case"mathspeak":default:return"mathspeak"}},Enable:function(t,e){s.explorer=!0,e&&(g.explorer=!0),MathJax.Extension.collapsible.Enable(!1,e),MathJax.Extension.AssistiveMML&&(MathJax.Extension.AssistiveMML.config.disabled=!0,s.assistiveMML=!1,e&&(g.assistiveMML=!1)),this.DisableMenus(!1),this.hook||(this.hook=MathJax.Hub.Register.MessageHook("New Math",["Register",this.Explorer])),this.locHook||(this.locHook=MathJax.Hub.Register.MessageHook("Locale Reset",["RemoveSpeech",this.Explorer])),t&&MathJax.Hub.Queue(["Reprocess",MathJax.Hub])},Disable:function(t,e){s.explorer=!1,e&&(g.explorer=!1),this.DisableMenus(!0),this.hook&&(MathJax.Hub.UnRegister.MessageHook(this.hook),this.hook=null);for(var n=this.dependents.length-1;0<=n;n--){var i=this.dependents[n];i.Disable&&i.Disable(!1,e)}},DisableMenus:function(t){if(MathJax.Menu){var e=MathJax.Menu.menu.FindId("Accessibility","Explorer");if(e){for(var n,i=(e=e.submenu).items,r=2;n=i[r];r++)n.disabled=t;t||!e.FindId("SpeechOutput")||s[o.prefix+"speech"]||(e.FindId("Subtitles").disabled=!0)}}},Dependent:function(t){this.dependents.push(t)}},l=MathJax.Object.Subclass({div:null,inner:null,Init:function(){this.div=l.Create("assertive"),this.inner=MathJax.HTML.addElement(this.div,"div")},Add:function(){l.added||(document.body.appendChild(this.div),l.added=!0)},Show:function(t,e){this.div.classList.add("MJX_LiveRegion_Show");var n=t.getBoundingClientRect(),i=n.bottom+10+window.pageYOffset,r=n.left+window.pageXOffset;this.div.style.top=i+"px",this.div.style.left=r+"px";var h=e.colorString();this.inner.style.backgroundColor=h.background,this.inner.style.color=h.foreground},Hide:function(t){this.div.classList.remove("MJX_LiveRegion_Show")},Clear:function(){this.Update(""),this.inner.style.top="",this.inner.style.backgroundColor=""},Update:function(t){o.getOption("speech")&&l.Update(this.inner,t)}},{ANNOUNCE:"Navigatable Math in page. Explore with enter or shift space and arrow keys. Expand or collapse elements hitting enter.",announced:!1,added:!1,styles:{".MJX_LiveRegion":{position:"absolute",top:"0",height:"1px",width:"1px",padding:"1px",overflow:"hidden"},".MJX_LiveRegion_Show":{top:"0",position:"absolute",width:"auto",height:"auto",padding:"0px 0px",opacity:1,"z-index":"202",left:0,right:0,margin:"0 auto","background-color":"white","box-shadow":"0px 10px 20px #888",border:"2px solid #CCCCCC"}},Create:function(t){var e=MathJax.HTML.Element("div",{className:"MJX_LiveRegion"});return e.setAttribute("aria-live",t),e},Update:MathJax.Hub.Browser.isPC?function(t,e){t.textContent="",setTimeout(function(){t.textContent=e},100)}:function(t,e){t.textContent="",t.textContent=e},Announce:function(){var t;o.getOption("speech")&&(l.announced=!0,MathJax.Ajax.Styles(l.styles),t=l.Create("polite"),document.body.appendChild(t),l.Update(t,l.ANNOUNCE),setTimeout(function(){document.body.removeChild(t)},1e3))}});MathJax.Extension.explorer.LiveRegion=l;var v=MathJax.Ajax.fileURL(MathJax.Ajax.config.path.a11y),a=MathJax.Extension.explorer.Explorer={liveRegion:l(),walker:null,highlighter:null,hoverer:null,flamer:null,speechDiv:null,earconFile:v+"/invalid_keypress"+(["Firefox","Chrome","Opera"].indexOf(MathJax.Hub.Browser.name)!==-1?".ogg":".mp3"),expanded:!1,focusoutEvent:MathJax.Hub.Browser.isFirefox?"blur":"focusout",focusinEvent:"focus",ignoreFocusOut:!1,jaxCache:{},messageID:null,Reset:function(){a.FlameEnriched()},Register:function(t){var e,n;!o.hook||(e=document.getElementById(t[1]))&&e.id&&(n=MathJax.Hub.getJaxFor(e.id))&&n.enriched&&(a.StateChange(e.id,n),a.liveRegion.Add(),a.AddEvent(e))},StateChange:function(t,e){a.GetHighlighter(.2);var n=a.jaxCache[t];n&&n===e.root||(n&&sre.Walker.resetState(t+"-Frame"),a.jaxCache[t]=e.root)},AddAria:function(t){t.setAttribute("role","application"),t.setAttribute("aria-label","Math")},AddHook:function(t){a.RemoveHook(),a.hook=MathJax.Hub.Register.MessageHook("End Math",function(e){var n=e[1].id+"-Frame",i=document.getElementById(n);t&&n===a.expanded&&(a.ActivateWalker(i,t),i.focus(),a.expanded=!1)})},RemoveHook:function(){a.hook&&(MathJax.Hub.UnRegister.MessageHook(a.hook),a.hook=null)},AddMessage:function(){return MathJax.Message.Set("Generating Speech Output")},RemoveMessage:function(t){t&&MathJax.Message.Clear(t)},AddEvent:function(t){var e,n=t.id+"-Frame",i=t.previousSibling;i&&(e=i.id!==n?i.firstElementChild:i,a.AddAria(e),a.AddMouseEvents(e),e.className==="MathJax_MathML"&&(e=e.firstElementChild),e&&(e.onkeydown=a.Keydown,a.Flame(e),e.addEventListener(a.focusinEvent,function(r){o.hook&&(l.announced||l.Announce())}),e.addEventListener(a.focusoutEvent,function(r){o.hook&&(a.ignoreFocusOut&&(a.ignoreFocusOut=!1,a.walker.moved==="enter")?r.target.focus():a.walker&&a.DeactivateWalker())}),o.getOption("speech")&&a.AddSpeech(e)))},AddSpeech:function(t){var e=t.id,n=MathJax.Hub.getJaxFor(e).root.toMathML();if(t.getAttribute("haslabel")||a.AddMathLabel(n,e),!t.getAttribute("hasspeech"))switch(MathJax.Hub.config.explorer.generation){case"eager":a.AddSpeechEager(n,e);break;case"mixed":t.querySelectorAll("[data-semantic-complexity]").length>=o.eagerComplexity&&a.AddSpeechEager(n,e)}},AddSpeechLazy:function(t){var e=new sre.TreeSpeechGenerator;e.setRebuilt(a.walker.getRebuilt()),e.getSpeech(a.walker.rootNode,a.walker.getXml()),t.setAttribute("hasspeech","true")},AddSpeechEager:function(t,e){a.MakeSpeechTask(t,e,sre.TreeSpeechGenerator,function(n,i){n.setAttribute("hasspeech","true")},5)},AddMathLabel:function(t,e){a.MakeSpeechTask(t,e,sre.SummarySpeechGenerator,function(n,i){n.setAttribute("haslabel","true"),n.setAttribute("aria-label",i)},5)},MakeSpeechTask:function(t,e,n,i,r){var h=a.AddMessage();setTimeout(function(){var c=new n,p=document.getElementById(e),x=new sre.DummyWalker(p,c,a.highlighter,t).speech();x&&i(p,x),a.RemoveMessage(h)},r)},Keydown:function(t){var e=t.keyCode;if(e===u.ESCAPE)return a.walker?(a.RemoveHook(),a.DeactivateWalker(),void d(t)):void 0;if(a.walker&&a.walker.isActive()){e=e===u.RETURN?u.DASH:e,a.walker.modifier!==void 0&&(a.walker.modifier=t.shiftKey);var n=a.walker.move(e);if(n===null)return;if(n){if(a.walker.moved==="expand"){if(a.expanded=a.walker.node.id,MathJax.Hub.Browser.isEdge)return a.ignoreFocusOut=!0,void a.DeactivateWalker();if(MathJax.Hub.Browser.isFirefox||MathJax.Hub.Browser.isMSIE)return void a.DeactivateWalker()}a.liveRegion.Update(a.walker.speech()),a.Highlight()}else a.PlayEarcon();d(t)}else{var i=t.target;if(e===u.SPACE&&!t.shiftKey)return MathJax.Extension.MathEvents.Event.ContextMenu(t,i),void d(t);if(o.hook&&(e===u.RETURN||e===u.SPACE&&t.shiftKey)){var r=MathJax.Hub.getJaxFor(i);return a.ActivateWalker(i,r),a.AddHook(r),void d(t)}}},GetHighlighter:function(t){a.highlighter=sre.HighlighterFactory.highlighter({color:o.getOption("background"),alpha:t},{color:o.getOption("foreground"),alpha:1},{renderer:MathJax.Hub.outputJax["jax/mml"][0].id,browser:MathJax.Hub.Browser.name})},AddMouseEvents:function(t){sre.HighlighterFactory.addEvents(t,{mouseover:a.MouseOver,mouseout:a.MouseOut},{renderer:MathJax.Hub.outputJax["jax/mml"][0].id,browser:MathJax.Hub.Browser.name})},MouseOver:function(t){var e;o.getOption("highlight")!=="none"&&(o.getOption("highlight")==="hover"&&(e=t.currentTarget,a.GetHighlighter(.1),a.highlighter.highlight([e]),a.hoverer=!0),d(t))},MouseOut:function(t){return a.hoverer&&(a.highlighter.unhighlight(),a.hoverer=!1),d(t)},Flame:function(t){if(o.getOption("highlight")==="flame")return a.GetHighlighter(.05),a.highlighter.highlightAll(t),void(a.flamer=!0)},UnFlame:function(){a.flamer&&(a.highlighter.unhighlightAll(),a.flamer=null)},FlameEnriched:function(){a.UnFlame();for(var t,e=0,n=MathJax.Hub.getAllJax();t=n[e];e++)a.Flame(t.SourceElement().previousSibling)},Walkers:{syntactic:sre.SyntaxWalker,table:sre.TableWalker,semantic:sre.SemanticWalker,none:sre.DummyWalker},ActivateWalker:function(t,e){var n=o.getOption("speech"),i=o.getOption("walker")?a.Walkers[MathJax.Hub.config.explorer.walker]:a.Walkers.none,r=n?new sre.DirectSpeechGenerator:new sre.DummySpeechGenerator,h=sre.System.getInstance().engineSetup();r.setOptions({locale:h.locale,domain:h.domain,style:h.style,modality:"speech"}),a.GetHighlighter(.2),a.walker=new i(t,r,a.highlighter,e.root.toMathML()),n&&!t.getAttribute("hasspeech")&&a.AddSpeechLazy(t),a.walker.activate(),n&&(o.getOption("subtitle")&&a.liveRegion.Show(t,a.highlighter),a.liveRegion.Update(a.walker.speech())),a.Highlight(),a.ignoreFocusOut&&setTimeout(function(){a.ignoreFocusOut=!1},500)},DeactivateWalker:function(){var t=sre.System.getInstance().engineSetup(),e=t.domain==="clearspeak"?"default":t.style;o.setOption("ruleset",t.domain+"-"+e),a.liveRegion.Clear(),a.liveRegion.Hide(),a.Unhighlight(),a.currentHighlight=null,a.walker.deactivate(),a.walker=null},Highlight:function(){a.Unhighlight(),a.highlighter.highlight(a.walker.getFocus().getNodes())},Unhighlight:function(){a.highlighter.unhighlight()},PlayEarcon:function(){new Audio(a.earconFile).play()},SpeechOutput:function(){a.Reset(),["Subtitles"].forEach(function(t){var e=MathJax.Menu.menu.FindId("Accessibility","Explorer",t);e&&(e.disabled=!e.disabled)}),a.Regenerate()},RemoveSpeech:function(){o.setSpeechOption();for(var t,e=0,n=MathJax.Hub.getAllJax();t=n[e];e++){var i=document.getElementById(t.inputID+"-Frame");i&&(i.removeAttribute("hasspeech"),i.removeAttribute("haslabel"))}},Regenerate:function(){for(var t,e=0,n=MathJax.Hub.getAllJax();t=n[e];e++){var i=document.getElementById(t.inputID+"-Frame");i&&(i.removeAttribute("hasspeech"),a.AddSpeech(i))}},Startup:function(){var t=MathJax.Extension.collapsible;t&&t.Dependent(o),o.addDefaults()}};MathJax.Hub.Register.StartupHook("End Extensions",function(){o[s.explorer===!1?"Disable":"Enable"](),MathJax.Hub.Startup.signal.Post("Explorer Ready"),MathJax.Hub.Register.StartupHook("MathMenu Ready",function(){g=MathJax.Menu.cookie;var t,e=MathJax.Menu.ITEM,n=MathJax.Menu.menu,i={action:a.Reset},r={action:o.speechOption},h=e.SUBMENU(["Explorer","Explorer"],e.CHECKBOX(["Active","Active"],"explorer",{action:function(p){o[s.explorer?"Enable":"Disable"](!0,!0),MathJax.Menu.saveCookie()}}),e.RULE(),e.CHECKBOX(["Walker","Walker"],"Assistive-walker"),e.SUBMENU(["Highlight","Highlight"],e.RADIO(["none","None"],"Assistive-highlight",i),e.RADIO(["hover","Hover"],"Assistive-highlight",i),e.RADIO(["flame","Flame"],"Assistive-highlight",i)),e.SUBMENU(["Background","Background"],e.RADIO(["blue","Blue"],"Assistive-background",i),e.RADIO(["red","Red"],"Assistive-background",i),e.RADIO(["green","Green"],"Assistive-background",i),e.RADIO(["yellow","Yellow"],"Assistive-background",i),e.RADIO(["cyan","Cyan"],"Assistive-background",i),e.RADIO(["magenta","Magenta"],"Assistive-background",i),e.RADIO(["white","White"],"Assistive-background",i),e.RADIO(["black","Black"],"Assistive-background",i)),e.SUBMENU(["Foreground","Foreground"],e.RADIO(["black","Black"],"Assistive-foreground",i),e.RADIO(["white","White"],"Assistive-foreground",i),e.RADIO(["magenta","Magenta"],"Assistive-foreground",i),e.RADIO(["cyan","Cyan"],"Assistive-foreground",i),e.RADIO(["yellow","Yellow"],"Assistive-foreground",i),e.RADIO(["green","Green"],"Assistive-foreground",i),e.RADIO(["red","Red"],"Assistive-foreground",i),e.RADIO(["blue","Blue"],"Assistive-foreground",i)),e.RULE(),e.CHECKBOX(["SpeechOutput","Speech Output"],"Assistive-speech",{action:a.SpeechOutput}),e.CHECKBOX(["Subtitles","Subtitles"],"Assistive-subtitle",{disabled:!s["Assistive-speech"]}),e.RULE(),e.SUBMENU(["Mathspeak","Mathspeak Rules"],e.RADIO(["mathspeak-default","Verbose"],"Assistive-ruleset",r),e.RADIO(["mathspeak-brief","Brief"],"Assistive-ruleset",r),e.RADIO(["mathspeak-sbrief","Superbrief"],"Assistive-ruleset",r)),e.RADIO(["clearspeak-default","Clearspeak Rules"],"Assistive-ruleset",r),e.SUBMENU(["Chromevox","ChromeVox Rules"],e.RADIO(["chromevox-default","Verbose"],"Assistive-ruleset",r),e.RADIO(["chromevox-alternative","Alternative"],"Assistive-ruleset",r))),c=(n.FindId("Accessibility")||{}).submenu;c?(t=c.IndexOfId("Explorer"))!==null?c.items[t]=h:(t=c.IndexOfId("CollapsibleMath"),c.items.splice(t+1,0,h)):(t=n.IndexOfId("CollapsibleMath"),n.items.splice(t+1,0,h)),s.explorer||o.DisableMenus(!0)},20)},20)}),MathJax.Hub.Register.StartupHook("SVG Jax Ready",function(){MathJax.Hub.Config({SVG:{addMMLclasses:!0}});var d,u=MathJax.OutputJax.SVG;parseFloat(u.version)<2.7&&(d=u.getJaxFromMath,u.Augment({getJaxFromMath:function(s){return s.parentNode.className.match(/MathJax_SVG_Display/)&&(s=s.parentNode),d.call(this,s)}}))}),MathJax.Ajax.config.path.a11y||(MathJax.Ajax.config.path.a11y=MathJax.Hub.config.root+"/extensions/a11y"),MathJax.Ajax.Require("[a11y]/collapsible.js"),MathJax.Hub.Register.StartupHook("Collapsible Ready",function(){MathJax.Extension.explorer.Explorer.Startup(),MathJax.Ajax.loadComplete("[a11y]/explorer.js")});
